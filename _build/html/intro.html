
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CA4015 - Clustering Analysis of the Iowa Gambling Task</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-2 bd-sidebar site-navigation show single-page" id="site-navigation">
    
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/dockreg/ca4015_assignment_1"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/dockreg/ca4015_assignment_1/issues/new?title=Issue%20on%20page%20%2Fintro.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toctree-l1 toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="intro.html#document-content/Data_Cleaning">
   Data Cleaning
  </a>
 </li>
 <li class="toctree-l1 toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="intro.html#data-manipulations">
   Data manipulations
  </a>
 </li>
 <li class="toctree-l1 toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="intro.html#document-content/K_Means_Clustering">
   Data Preprocessing, Standardization, and K-means clustering
  </a>
 </li>
 <li class="toctree-l1 toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="intro.html#preprocessing">
   Preprocessing
  </a>
 </li>
 <li class="toctree-l1 toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="intro.html#document-content/Privacy_preserving_k_means">
   Privacy Preserving k-means
  </a>
 </li>
 <li class="toctree-l1 toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="intro.html#analysis">
   Analysis
  </a>
 </li>
 <li class="toctree-l1 toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="intro.html#document-conclusion">
   Conclusion
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>The Iowa gambling task is a study that was created to model human decision making. It seeks to explore our ability to learn and how we may react to varying levels of rewards and punishments due to the decisions we have made. The Iowa Gambling involves four decks of cards (A, B, C and D). Participants must choose a card from these four decks. Each deck choice is a single trial and participants complete a task of ninety five, one hundred or one hundred and fifty trials, depending on which study they are part of. The four decks are not all equal, and although there are variations from study to study, the premise of the study is that there are good decks and bad decks. The good decks reward participants for consistently choosing cards from these decks while the bad decks will result in a loss of money over time if they are consistently selected. There are other intricacies from deck to deck such as a variable win and variable loss function that changes over time. The participants are told their task is to maximise their profit by choosing correctly.</p>
<div class="section" id="uses-of-the-iowa-gambling-task">
<h2>Uses of the Iowa Gambling Task<a class="headerlink" href="#uses-of-the-iowa-gambling-task" title="Permalink to this headline">¶</a></h2>
<p>The Iowa Gambling Task has been used to test the decision making of healthy participants vs participants with damage to the prefontal cortex which may impact their decision making. The theory proposed is that healthy participants show an ability to learn from their choices and will tend towards the decks which maximise their earning potential. Conversely the unhealthy participants may not learn from previous choices or may even tend towards more severe punishments from certain bad decks.</p>
</div>
<div class="section" id="our-analysis">
<h2>Our analysis<a class="headerlink" href="#our-analysis" title="Permalink to this headline">¶</a></h2>
<p>We seek to explore the Iowa Gambling task using a clustering algorithm. The data used in this project comes from 617 participants across 10 studies. We explore the data to understand any insights or trends and then further investigate any beliefes we have around potential clustering with the k-means clustering algorithm.</p>
</div>
<div class="toctree-wrapper compound">
<span id="document-content/Data_Cleaning"></span><div class="section" id="data-cleaning">
<h2>Data Cleaning<a class="headerlink" href="#data-cleaning" title="Permalink to this headline">¶</a></h2>
<p>We load in the relevant files for inspection and carry out a number of data manipulations, visualisations and processes to understand and analyse our data before proceeding with the clustering algorithm. We also format our data into a single source for our clustering algorithm.</p>
<div class="section" id="importing-required-libraries">
<h3>Importing required libraries<a class="headerlink" href="#importing-required-libraries" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="data-import">
<h3>Data Import<a class="headerlink" href="#data-import" title="Permalink to this headline">¶</a></h3>
<p>Our data is split across 12 files.
These are split into trials of length 95, length 100 and length 150.
The wi_95 file contains all wins from the 95 trials for each subject, lo_95 contains the losses, index_95 contains which study each subject relates to and choice_95 details what deck each subject chose across each trial.</p>
<p>These files contain data from 617 healthy subjects who have participated in the Iowa Gambling Task. These participants are split accross 10 independant studies with a variety of participants and length of trial:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Study</p></th>
<th class="head"><p>Participants</p></th>
<th class="head"><p>Trials</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>Fridberg et al.</p></td>
<td><p>15</p></td>
<td><p>95</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Horstmannb</p></td>
<td><p>162</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Kjome et al.</p></td>
<td><p>19</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Maia &amp; McClelland</p></td>
<td><p>40</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Premkumar et al.</p></td>
<td><p>25</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Steingroever et al.</p></td>
<td><p>70</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Steingroever et al.</p></td>
<td><p>57</p></td>
<td><p>150</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Wetzels et al.</p></td>
<td><p>41</p></td>
<td><p>150</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Wood et al.</p></td>
<td><p>153</p></td>
<td><p>100</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Worthy et al.</p></td>
<td><p>35</p></td>
<td><p>100</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#import raw data into dataframes</span>
<span class="n">wi_95</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/wi_95.csv&#39;</span><span class="p">)</span>
<span class="n">wi_100</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/wi_100.csv&#39;</span><span class="p">)</span>
<span class="n">wi_150</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/wi_150.csv&#39;</span><span class="p">)</span>
<span class="n">lo_95</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/lo_95.csv&#39;</span><span class="p">)</span>
<span class="n">lo_100</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/lo_100.csv&#39;</span><span class="p">)</span>
<span class="n">lo_150</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/lo_150.csv&#39;</span><span class="p">)</span>
<span class="n">index_95</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/index_95.csv&#39;</span><span class="p">)</span>
<span class="n">index_100</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/index_100.csv&#39;</span><span class="p">)</span>
<span class="n">index_150</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/index_150.csv&#39;</span><span class="p">)</span>
<span class="n">choice_95</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/choice_95.csv&#39;</span><span class="p">)</span>
<span class="n">choice_100</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/choice_100.csv&#39;</span><span class="p">)</span>
<span class="n">choice_150</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/choice_150.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="inspection-of-the-raw-data">
<h3>Inspection of the raw data<a class="headerlink" href="#inspection-of-the-raw-data" title="Permalink to this headline">¶</a></h3>
<p>We display the wins, losses, index and choices for the trials of length 95 to understand the current format of the data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Display wins</span>
<span class="n">wi_95</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Wins_1</th>
      <th>Wins_2</th>
      <th>Wins_3</th>
      <th>Wins_4</th>
      <th>Wins_5</th>
      <th>Wins_6</th>
      <th>Wins_7</th>
      <th>Wins_8</th>
      <th>Wins_9</th>
      <th>Wins_10</th>
      <th>...</th>
      <th>Wins_86</th>
      <th>Wins_87</th>
      <th>Wins_88</th>
      <th>Wins_89</th>
      <th>Wins_90</th>
      <th>Wins_91</th>
      <th>Wins_92</th>
      <th>Wins_93</th>
      <th>Wins_94</th>
      <th>Wins_95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Subj_1</th>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>...</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
    </tr>
    <tr>
      <th>Subj_2</th>
      <td>100</td>
      <td>100</td>
      <td>50</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>...</td>
      <td>50</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
    </tr>
    <tr>
      <th>Subj_3</th>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>...</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
    </tr>
    <tr>
      <th>Subj_4</th>
      <td>50</td>
      <td>50</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>50</td>
      <td>100</td>
      <td>100</td>
      <td>...</td>
      <td>100</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
    </tr>
    <tr>
      <th>Subj_5</th>
      <td>100</td>
      <td>100</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>100</td>
      <td>...</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 95 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Display losses</span>
<span class="n">lo_95</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Losses_1</th>
      <th>Losses_2</th>
      <th>Losses_3</th>
      <th>Losses_4</th>
      <th>Losses_5</th>
      <th>Losses_6</th>
      <th>Losses_7</th>
      <th>Losses_8</th>
      <th>Losses_9</th>
      <th>Losses_10</th>
      <th>...</th>
      <th>Losses_86</th>
      <th>Losses_87</th>
      <th>Losses_88</th>
      <th>Losses_89</th>
      <th>Losses_90</th>
      <th>Losses_91</th>
      <th>Losses_92</th>
      <th>Losses_93</th>
      <th>Losses_94</th>
      <th>Losses_95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Subj_1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-1250</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-250</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Subj_2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>-50</td>
      <td>-300</td>
      <td>0</td>
      <td>-350</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-25</td>
    </tr>
    <tr>
      <th>Subj_3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-150</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-250</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Subj_4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-150</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>-50</td>
      <td>0</td>
      <td>-50</td>
      <td>-50</td>
      <td>0</td>
      <td>-25</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Subj_5</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-150</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>-75</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 95 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Display index</span>
<span class="n">index_95</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Subj</th>
      <th>Study</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Fridberg</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Display choices</span>
<span class="n">choice_95</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Choice_1</th>
      <th>Choice_2</th>
      <th>Choice_3</th>
      <th>Choice_4</th>
      <th>Choice_5</th>
      <th>Choice_6</th>
      <th>Choice_7</th>
      <th>Choice_8</th>
      <th>Choice_9</th>
      <th>Choice_10</th>
      <th>...</th>
      <th>Choice_86</th>
      <th>Choice_87</th>
      <th>Choice_88</th>
      <th>Choice_89</th>
      <th>Choice_90</th>
      <th>Choice_91</th>
      <th>Choice_92</th>
      <th>Choice_93</th>
      <th>Choice_94</th>
      <th>Choice_95</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Subj_1</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Subj_2</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Subj_3</th>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Subj_4</th>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Subj_5</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 95 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="data-manipulations">
<h2>Data manipulations<a class="headerlink" href="#data-manipulations" title="Permalink to this headline">¶</a></h2>
<p>We want to consolidate the data into a single dataframe with certain features. The first step is to aggregate the choices for all subjects into single columns for each card deck.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Count values for each choice by deck</span>
<span class="n">agg_choice_95</span> <span class="o">=</span> <span class="n">choice_95</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">value_counts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">agg_choice_100</span> <span class="o">=</span> <span class="n">choice_100</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">value_counts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">agg_choice_150</span> <span class="o">=</span> <span class="n">choice_150</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="o">.</span><span class="n">value_counts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Display aggregated choice data</span>
<span class="n">agg_choice_95</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Subj_1</th>
      <td>12</td>
      <td>9</td>
      <td>3</td>
      <td>71</td>
    </tr>
    <tr>
      <th>Subj_2</th>
      <td>24</td>
      <td>26</td>
      <td>12</td>
      <td>33</td>
    </tr>
    <tr>
      <th>Subj_3</th>
      <td>12</td>
      <td>35</td>
      <td>10</td>
      <td>38</td>
    </tr>
    <tr>
      <th>Subj_4</th>
      <td>11</td>
      <td>34</td>
      <td>12</td>
      <td>38</td>
    </tr>
    <tr>
      <th>Subj_5</th>
      <td>10</td>
      <td>24</td>
      <td>15</td>
      <td>46</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We add columns labelled with the total wins and total losses for each subject calculated from the wins and losses raw data we previously imported</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#calculate total wins and total losses for each subject</span>
<span class="n">agg_choice_95</span><span class="p">[</span><span class="s2">&quot;tot_win&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wi_95</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">agg_choice_95</span><span class="p">[</span><span class="s2">&quot;tot_los&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lo_95</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">agg_choice_100</span><span class="p">[</span><span class="s2">&quot;tot_win&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wi_100</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">agg_choice_100</span><span class="p">[</span><span class="s2">&quot;tot_los&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lo_100</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">agg_choice_150</span><span class="p">[</span><span class="s2">&quot;tot_win&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wi_150</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">agg_choice_150</span><span class="p">[</span><span class="s2">&quot;tot_los&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lo_150</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#resetting index for concatination in the next cell</span>
<span class="n">agg_choice_95</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">agg_choice_100</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">agg_choice_150</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We then add the index dataframe so as to know which Study each subject is from which will aid with our analysis and visualisations later on</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">agg_choice_95</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>tot_win</th>
      <th>tot_los</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Subj_1</td>
      <td>12</td>
      <td>9</td>
      <td>3</td>
      <td>71</td>
      <td>5800</td>
      <td>-4650</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Subj_2</td>
      <td>24</td>
      <td>26</td>
      <td>12</td>
      <td>33</td>
      <td>7250</td>
      <td>-7925</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Subj_3</td>
      <td>12</td>
      <td>35</td>
      <td>10</td>
      <td>38</td>
      <td>7100</td>
      <td>-7850</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Subj_4</td>
      <td>11</td>
      <td>34</td>
      <td>12</td>
      <td>38</td>
      <td>7000</td>
      <td>-7525</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Subj_5</td>
      <td>10</td>
      <td>24</td>
      <td>15</td>
      <td>46</td>
      <td>6450</td>
      <td>-6350</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Concatenate index to identify the study</span>
<span class="n">final_95</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">agg_choice_95</span><span class="p">,</span> <span class="n">index_95</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">final_100</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">agg_choice_100</span><span class="p">,</span> <span class="n">index_100</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">final_150</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">agg_choice_150</span><span class="p">,</span> <span class="n">index_150</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_95</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Subj</th>
      <th>Study</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Subj_1</td>
      <td>12</td>
      <td>9</td>
      <td>3</td>
      <td>71</td>
      <td>5800</td>
      <td>-4650</td>
      <td>1</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Subj_2</td>
      <td>24</td>
      <td>26</td>
      <td>12</td>
      <td>33</td>
      <td>7250</td>
      <td>-7925</td>
      <td>2</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Subj_3</td>
      <td>12</td>
      <td>35</td>
      <td>10</td>
      <td>38</td>
      <td>7100</td>
      <td>-7850</td>
      <td>3</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Subj_4</td>
      <td>11</td>
      <td>34</td>
      <td>12</td>
      <td>38</td>
      <td>7000</td>
      <td>-7525</td>
      <td>4</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Subj_5</td>
      <td>10</td>
      <td>24</td>
      <td>15</td>
      <td>46</td>
      <td>6450</td>
      <td>-6350</td>
      <td>5</td>
      <td>Fridberg</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We inspect the new dataframes to see if our aggregation has created any null values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Display summary info for our data types accross the three dataframes we have created</span>
<span class="n">final_95</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">final_100</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">final_150</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 15 entries, 0 to 14
Data columns (total 9 columns):
 #   Column   Non-Null Count  Dtype 
---  ------   --------------  ----- 
 0   index    15 non-null     object
 1   1        15 non-null     int64 
 2   2        15 non-null     int64 
 3   3        15 non-null     int64 
 4   4        15 non-null     int64 
 5   tot_win  15 non-null     int64 
 6   tot_los  15 non-null     int64 
 7   Subj     15 non-null     int64 
 8   Study    15 non-null     object
dtypes: int64(7), object(2)
memory usage: 1.2+ KB
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 504 entries, 0 to 503
Data columns (total 9 columns):
 #   Column   Non-Null Count  Dtype 
---  ------   --------------  ----- 
 0   index    504 non-null    object
 1   1        504 non-null    int64 
 2   2        504 non-null    int64 
 3   3        504 non-null    int64 
 4   4        504 non-null    int64 
 5   tot_win  504 non-null    int64 
 6   tot_los  504 non-null    int64 
 7   Subj     504 non-null    int64 
 8   Study    504 non-null    object
dtypes: int64(7), object(2)
memory usage: 35.6+ KB
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 98 entries, 0 to 97
Data columns (total 9 columns):
 #   Column   Non-Null Count  Dtype  
---  ------   --------------  -----  
 0   index    98 non-null     object 
 1   1        96 non-null     float64
 2   2        96 non-null     float64
 3   3        98 non-null     float64
 4   4        96 non-null     float64
 5   tot_win  98 non-null     int64  
 6   tot_los  98 non-null     int64  
 7   Subj     98 non-null     int64  
 8   Study    98 non-null     object 
dtypes: float64(4), int64(3), object(2)
memory usage: 7.0+ KB
</pre></div>
</div>
</div>
</div>
<p>This has shown the presence of six null values within the final_150 dataframe. Further inspection of these null values may show us an insight into some participants choices in this task</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">final_150</span><span class="p">[</span><span class="n">final_150</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
<span class="n">sample</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Subj</th>
      <th>Study</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>Subj_8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>NaN</td>
      <td>7500</td>
      <td>-3750</td>
      <td>8</td>
      <td>Steingroever2011</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Subj_57</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>NaN</td>
      <td>7500</td>
      <td>-3750</td>
      <td>57</td>
      <td>Steingroever2011</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="note">
<h3>Note<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h3>
<p>Interestingly this step has shown that two participants, both from the Steingroever2011 study chose deck 3 for 150 consecutive trials. It would be interesting to know whether this was a tactical choice with prior knowledge of how the Iowa gambling task is set up - i.e. with decks 3 and 4 giving the best returns. This may have also been a tactic to quickly finish the game from a participant who was uninterested in the game itself. Either way this slightly varies from the expected results of the Iowa Gambling task in which we expect subjects to show a variety of choices but ultimately learn which of the decks are more rewarding.</p>
<p>We replace these cells marked as Null with 0 across the data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#replace all NaN values with &#39;0&#39;</span>
<span class="n">final_150</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_150</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">final_150</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_150</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">final_150</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_150</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We change all columns to type int from type float</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#convert float to int</span>
<span class="n">final_150</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_150</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">final_150</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_150</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">final_150</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_150</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">final_150</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">final_150</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We then bring all three dataframes together into a single dataframe named ‘final’. This is comprised of:</p>
<ul class="simple">
<li><p>Trials of length 95</p></li>
<li><p>Trials of length 100</p></li>
<li><p>Trials of length 150</p></li>
</ul>
<p>We can then do manipulations across all of this data all at once</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#creation of a single dataframe with all 617 subjects accross all studies</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">final_95</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_100</span><span class="p">)</span>
<span class="n">final</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">final_150</span><span class="p">)</span>
<span class="n">final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Subj</th>
      <th>Study</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Subj_1</td>
      <td>12</td>
      <td>9</td>
      <td>3</td>
      <td>71</td>
      <td>5800</td>
      <td>-4650</td>
      <td>1</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Subj_2</td>
      <td>24</td>
      <td>26</td>
      <td>12</td>
      <td>33</td>
      <td>7250</td>
      <td>-7925</td>
      <td>2</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Subj_3</td>
      <td>12</td>
      <td>35</td>
      <td>10</td>
      <td>38</td>
      <td>7100</td>
      <td>-7850</td>
      <td>3</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Subj_4</td>
      <td>11</td>
      <td>34</td>
      <td>12</td>
      <td>38</td>
      <td>7000</td>
      <td>-7525</td>
      <td>4</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Subj_5</td>
      <td>10</td>
      <td>24</td>
      <td>15</td>
      <td>46</td>
      <td>6450</td>
      <td>-6350</td>
      <td>5</td>
      <td>Fridberg</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Subj_94</td>
      <td>24</td>
      <td>69</td>
      <td>13</td>
      <td>44</td>
      <td>12150</td>
      <td>-11850</td>
      <td>94</td>
      <td>Wetzels</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Subj_95</td>
      <td>5</td>
      <td>31</td>
      <td>46</td>
      <td>68</td>
      <td>9300</td>
      <td>-7150</td>
      <td>95</td>
      <td>Wetzels</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Subj_96</td>
      <td>18</td>
      <td>19</td>
      <td>37</td>
      <td>76</td>
      <td>9350</td>
      <td>-7900</td>
      <td>96</td>
      <td>Wetzels</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Subj_97</td>
      <td>25</td>
      <td>30</td>
      <td>44</td>
      <td>51</td>
      <td>10250</td>
      <td>-9050</td>
      <td>97</td>
      <td>Wetzels</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Subj_98</td>
      <td>11</td>
      <td>104</td>
      <td>6</td>
      <td>29</td>
      <td>13250</td>
      <td>-15050</td>
      <td>98</td>
      <td>Wetzels</td>
    </tr>
  </tbody>
</table>
<p>617 rows × 9 columns</p>
</div></div></div>
</div>
<p>As can be seen from the above output - the dataframe contains 617 rows (one for each of the the participants). However we dont have a unique identifier for each subject. We also have the issue that there is Subject 1 for each of the three length trials data. We add a column with a unique ID for each of the 617 participants to overcome this issue. We also calculate the balance for each participant after the completion of their trials which is the total wins added to the total losses.</p>
<div class="math notranslate nohighlight">
\[wins + losses = balance\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#calculate balance and add Unique ID for participants</span>
<span class="n">final</span><span class="p">[</span><span class="s1">&#39;Unique_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">final</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">final</span><span class="p">[</span><span class="s2">&quot;balance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;tot_win&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;tot_los&quot;</span><span class="p">]</span>

<span class="n">final</span> <span class="o">=</span> <span class="n">final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;Deck_A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;Deck_B&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="s1">&#39;Deck_C&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="s1">&#39;Deck_D&#39;</span><span class="p">})</span>
<span class="n">final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>Deck_A</th>
      <th>Deck_B</th>
      <th>Deck_C</th>
      <th>Deck_D</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Subj</th>
      <th>Study</th>
      <th>Unique_ID</th>
      <th>balance</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Subj_1</td>
      <td>12</td>
      <td>9</td>
      <td>3</td>
      <td>71</td>
      <td>5800</td>
      <td>-4650</td>
      <td>1</td>
      <td>Fridberg</td>
      <td>1</td>
      <td>1150</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Subj_2</td>
      <td>24</td>
      <td>26</td>
      <td>12</td>
      <td>33</td>
      <td>7250</td>
      <td>-7925</td>
      <td>2</td>
      <td>Fridberg</td>
      <td>2</td>
      <td>-675</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Subj_3</td>
      <td>12</td>
      <td>35</td>
      <td>10</td>
      <td>38</td>
      <td>7100</td>
      <td>-7850</td>
      <td>3</td>
      <td>Fridberg</td>
      <td>3</td>
      <td>-750</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Subj_4</td>
      <td>11</td>
      <td>34</td>
      <td>12</td>
      <td>38</td>
      <td>7000</td>
      <td>-7525</td>
      <td>4</td>
      <td>Fridberg</td>
      <td>4</td>
      <td>-525</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Subj_5</td>
      <td>10</td>
      <td>24</td>
      <td>15</td>
      <td>46</td>
      <td>6450</td>
      <td>-6350</td>
      <td>5</td>
      <td>Fridberg</td>
      <td>5</td>
      <td>100</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Subj_94</td>
      <td>24</td>
      <td>69</td>
      <td>13</td>
      <td>44</td>
      <td>12150</td>
      <td>-11850</td>
      <td>94</td>
      <td>Wetzels</td>
      <td>613</td>
      <td>300</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Subj_95</td>
      <td>5</td>
      <td>31</td>
      <td>46</td>
      <td>68</td>
      <td>9300</td>
      <td>-7150</td>
      <td>95</td>
      <td>Wetzels</td>
      <td>614</td>
      <td>2150</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Subj_96</td>
      <td>18</td>
      <td>19</td>
      <td>37</td>
      <td>76</td>
      <td>9350</td>
      <td>-7900</td>
      <td>96</td>
      <td>Wetzels</td>
      <td>615</td>
      <td>1450</td>
    </tr>
    <tr>
      <th>96</th>
      <td>Subj_97</td>
      <td>25</td>
      <td>30</td>
      <td>44</td>
      <td>51</td>
      <td>10250</td>
      <td>-9050</td>
      <td>97</td>
      <td>Wetzels</td>
      <td>616</td>
      <td>1200</td>
    </tr>
    <tr>
      <th>97</th>
      <td>Subj_98</td>
      <td>11</td>
      <td>104</td>
      <td>6</td>
      <td>29</td>
      <td>13250</td>
      <td>-15050</td>
      <td>98</td>
      <td>Wetzels</td>
      <td>617</td>
      <td>-1800</td>
    </tr>
  </tbody>
</table>
<p>617 rows × 11 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="add-payoff-to-dataframe">
<h3>Add Payoff to Dataframe<a class="headerlink" href="#add-payoff-to-dataframe" title="Permalink to this headline">¶</a></h3>
<p>We are interested in the payoffs used in the various trials for the Iowa Gambling task study. There were three different kinds of payoff used in all the studies.</p>
<div class="section" id="payoff-1">
<h4>Payoff 1<a class="headerlink" href="#payoff-1" title="Permalink to this headline">¶</a></h4>
<p>This scheme gives +250 result from 10 choices of the good decks (C&amp;D) while giving a -250 result from 10 choices of the bad decks (A&amp;B). Payoff 1 also has a feature in which decks A&amp;C result in frequent losses while decks B&amp;D result in infrequent losses. Another feature of payoff 1 is that deck C has varialble loss between -25, -50 or -75. The final feature of Payoff 1 is that wins and losses are in a fixed sequence</p>
</div>
<div class="section" id="payoff-2">
<h4>Payoff 2<a class="headerlink" href="#payoff-2" title="Permalink to this headline">¶</a></h4>
<p>Payoff 2 is a variant on the first payoff with a number of changes. The first is that the loss from Deck C is constant at -50. The second change involves a random sequence of wins and losses through the trials.</p>
</div>
<div class="section" id="payoff-3">
<h4>Payoff 3<a class="headerlink" href="#payoff-3" title="Permalink to this headline">¶</a></h4>
<p>Payoff 3 is another variety which still contains the base feature of bad decks A&amp;B and good decks C&amp;D with A&amp;C having frequent losses and B&amp;D having infrequent losses. This scheme differs by having decks that change every 10 trials. This means the bad decks (A&amp;B) produce a -250 result from 10 trials at the start but this decreases by 150 for every 10 trials resulting in a final result of -1000 for 10 card chosen fromn the bad decks. Similarly the good decks start with a +250 result and increase by 25 with every 10 trials finishing with a reward of 375 for every 10 trials. This means both choices are magnified as the trials progress but also the punishment for choosing a bad deck increases far more than the reward for choosing a good deck. The final feature of payoff scheme 3 is that there is a difference in wins between decks and the sequence of wins and losses is fixed.</p>
<p>This variety in reward/punishment from payoff to payoff is an interesting factor in the outcomes of our project and so we will further explore how much of an impact this variety has within our clustering analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#payoff data</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Fridberg&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="s1">&#39;Horstmann&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="s1">&#39;Kjome&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="s1">&#39;Maia&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="s1">&#39;SteingroverInPrep&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="s1">&#39;Premkumar&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="s1">&#39;Wood&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="s1">&#39;Worthy&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="s1">&#39;Steingroever2011&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">],[</span><span class="s1">&#39;Wetzels&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
 
<span class="c1"># Create the pandas DataFrame</span>
<span class="n">payoff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">,</span> <span class="s1">&#39;Payoff&#39;</span><span class="p">])</span>
 
<span class="c1"># print dataframe.</span>
<span class="n">payoff</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Study</th>
      <th>Payoff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Fridberg</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Horstmann</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Kjome</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Maia</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SteingroverInPrep</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Premkumar</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Wood</td>
      <td>3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Worthy</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Steingroever2011</td>
      <td>2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Wetzels</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We join the final dataframe with the dataframe containing the payoff values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span> <span class="o">=</span> <span class="n">final</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">payoff</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Study&#39;</span><span class="p">),</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Study&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="export-data">
<h3>Export data<a class="headerlink" href="#export-data" title="Permalink to this headline">¶</a></h3>
<p>This final dataframe is in the appropriate format for clustering and for some initial visualisations and analysis. We export the data for use in the clustering notebook and then proceed with our exploration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/cleaned_data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exploration-of-the-data">
<h3>Exploration of the data<a class="headerlink" href="#exploration-of-the-data" title="Permalink to this headline">¶</a></h3>
<p>We want to further understand the data set to see if there are any insights or trends that we can explore during our clustering. A number of methods and graphs can help us to understand the make up of this data and what questions we want to answer within this project.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Deck_A</th>
      <th>Deck_B</th>
      <th>Deck_C</th>
      <th>Deck_D</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Subj</th>
      <th>Unique_ID</th>
      <th>balance</th>
      <th>Payoff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>617.000000</td>
      <td>617.000000</td>
      <td>617.000000</td>
      <td>617.000000</td>
      <td>617.000000</td>
      <td>617.000000</td>
      <td>617.000000</td>
      <td>617.000000</td>
      <td>617.000000</td>
      <td>617.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>15.813614</td>
      <td>33.388979</td>
      <td>26.320908</td>
      <td>32.296596</td>
      <td>8087.252836</td>
      <td>-8244.084279</td>
      <td>214.312804</td>
      <td>309.000000</td>
      <td>-156.831442</td>
      <td>2.173420</td>
    </tr>
    <tr>
      <th>std</th>
      <td>7.999550</td>
      <td>17.599469</td>
      <td>21.428470</td>
      <td>18.170402</td>
      <td>1555.720966</td>
      <td>2357.633329</td>
      <td>154.912903</td>
      <td>178.256837</td>
      <td>1251.585443</td>
      <td>0.660141</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>5300.000000</td>
      <td>-18800.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>-4250.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>10.000000</td>
      <td>22.000000</td>
      <td>14.000000</td>
      <td>21.000000</td>
      <td>7150.000000</td>
      <td>-9550.000000</td>
      <td>70.000000</td>
      <td>155.000000</td>
      <td>-1000.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>16.000000</td>
      <td>31.000000</td>
      <td>21.000000</td>
      <td>29.000000</td>
      <td>7750.000000</td>
      <td>-8100.000000</td>
      <td>196.000000</td>
      <td>309.000000</td>
      <td>-170.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>21.000000</td>
      <td>41.000000</td>
      <td>30.000000</td>
      <td>40.000000</td>
      <td>8480.000000</td>
      <td>-6650.000000</td>
      <td>350.000000</td>
      <td>463.000000</td>
      <td>650.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>48.000000</td>
      <td>143.000000</td>
      <td>150.000000</td>
      <td>135.000000</td>
      <td>14750.000000</td>
      <td>-2725.000000</td>
      <td>504.000000</td>
      <td>617.000000</td>
      <td>3750.000000</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can see that mean choices for decks B, C &amp; D are higher than Deck A showing a clear trend of participants away from A and towards the good decks C&amp;D. Interestingly the mean total wins is less than the mean average losses and hence participants mean balance was -156.83.</p>
</div>
<div class="section" id="analysis-by-individual">
<h3>Analysis by Individual<a class="headerlink" href="#analysis-by-individual" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create histogram for wins</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;tot_win&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Wins&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wins Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#create histogram for losses</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;tot_los&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Losses&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Losses Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Data_Cleaning_42_0.png" src="_images/Data_Cleaning_42_0.png" />
<img alt="_images/Data_Cleaning_42_1.png" src="_images/Data_Cleaning_42_1.png" />
</div>
</div>
<p>We can see wins has a right skew distribution with a small number of subjects with wins above 10,000. The losses is similarly distributed but with a left skew distribution. The presence of trials of length 150 in this data alongside the data of trials with length 95/100 would be partly the cause of this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create histogram for wins</span>

<span class="n">to_keep</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Fridberg&#39;</span><span class="p">,</span><span class="s1">&#39;Horstmann&#39;</span><span class="p">,</span><span class="s1">&#39;Kjome&#39;</span><span class="p">,</span><span class="s1">&#39;Maia&#39;</span><span class="p">,</span><span class="s1">&#39;SteingroverInPrep&#39;</span><span class="p">,</span><span class="s1">&#39;Premkumar&#39;</span><span class="p">,</span><span class="s1">&#39;Wood&#39;</span><span class="p">,</span><span class="s1">&#39;Worthy&#39;</span><span class="p">]</span>
<span class="n">filtered_df</span> <span class="o">=</span> <span class="n">final</span><span class="p">[</span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">to_keep</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;tot_win&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Wins for trials of length 95/100&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wins Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#create histogram for losses</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;tot_los&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Losses for trials of length 95/100&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Losses Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">filtered_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Data_Cleaning_44_0.png" src="_images/Data_Cleaning_44_0.png" />
<img alt="_images/Data_Cleaning_44_1.png" src="_images/Data_Cleaning_44_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Deck_A</th>
      <th>Deck_B</th>
      <th>Deck_C</th>
      <th>Deck_D</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Subj</th>
      <th>Unique_ID</th>
      <th>balance</th>
      <th>Payoff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>519.000000</td>
      <td>519.000000</td>
      <td>519.000000</td>
      <td>519.000000</td>
      <td>519.000000</td>
      <td>519.000000</td>
      <td>519.000000</td>
      <td>519.000000</td>
      <td>519.000000</td>
      <td>519.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>15.132948</td>
      <td>30.901734</td>
      <td>23.354528</td>
      <td>30.466281</td>
      <td>7575.211946</td>
      <td>-7832.080925</td>
      <td>245.433526</td>
      <td>260.000000</td>
      <td>-256.868979</td>
      <td>2.206166</td>
    </tr>
    <tr>
      <th>std</th>
      <td>7.125167</td>
      <td>13.933238</td>
      <td>14.957389</td>
      <td>14.430446</td>
      <td>881.667949</td>
      <td>1960.716200</td>
      <td>149.256183</td>
      <td>149.966663</td>
      <td>1169.048170</td>
      <td>0.715170</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>5300.000000</td>
      <td>-14800.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>-4250.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>10.000000</td>
      <td>22.000000</td>
      <td>13.000000</td>
      <td>21.000000</td>
      <td>7045.000000</td>
      <td>-9012.500000</td>
      <td>115.500000</td>
      <td>130.500000</td>
      <td>-1032.500000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>15.000000</td>
      <td>30.000000</td>
      <td>20.000000</td>
      <td>28.000000</td>
      <td>7600.000000</td>
      <td>-7800.000000</td>
      <td>245.000000</td>
      <td>260.000000</td>
      <td>-300.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>20.000000</td>
      <td>39.000000</td>
      <td>28.000000</td>
      <td>38.000000</td>
      <td>8100.000000</td>
      <td>-6512.500000</td>
      <td>374.500000</td>
      <td>389.500000</td>
      <td>550.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>38.000000</td>
      <td>79.000000</td>
      <td>84.000000</td>
      <td>92.000000</td>
      <td>10750.000000</td>
      <td>-2725.000000</td>
      <td>504.000000</td>
      <td>519.000000</td>
      <td>3570.000000</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can see once we remove the trials of length 150 the level of right skew in the wins histogram reduces as does the level of left skew in the losses histogram.</p>
</div>
<div class="section" id="analysis-by-payoff">
<h3>Analysis by Payoff<a class="headerlink" href="#analysis-by-payoff" title="Permalink to this headline">¶</a></h3>
<p>We now look at the distribution of the balance across the different payoff schemes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
    <span class="n">pay1</span> <span class="o">=</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Payoff&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">final</span><span class="p">[</span><span class="n">pay1</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;balance&#39;</span><span class="p">],</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Payoff &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; Balance Distribution&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Balance&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Data_Cleaning_47_0.png" src="_images/Data_Cleaning_47_0.png" />
<img alt="_images/Data_Cleaning_47_1.png" src="_images/Data_Cleaning_47_1.png" />
<img alt="_images/Data_Cleaning_47_2.png" src="_images/Data_Cleaning_47_2.png" />
</div>
</div>
<p>We can see payoff 2 has distribution that centers just above 0 while payoff 1 and 3 have a negative center - payoff 3 showing the worst results. This may be due to the sharp increase in penalty that occurs with every 10 cards chosen in payoff 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Show wins and losses by Payoff</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Payoff&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;tot_win&quot;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Total Wins&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Payoff&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;tot_los&quot;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Total Losses&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Wins/Losses by Payoff&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Payoff&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Data_Cleaning_49_0.png" src="_images/Data_Cleaning_49_0.png" />
</div>
</div>
<p>Payoff 2 shows the widest distribution across wins and losses while payoff 3 again shows a very tight distribution of wins but a wide variety of losses due to this evolving reward/punishment system every 10 cards.</p>
</div>
<div class="section" id="analysis-by-study">
<h3>Analysis by Study<a class="headerlink" href="#analysis-by-study" title="Permalink to this headline">¶</a></h3>
<p>Another theory we have is that the study in which the subject is part of may affect the participants results. We will explore this data with each study in miond to see if any obvious trends emerge. This may also be a useful clustering excercise to see if subjects will cluster with others in their study</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Show wins and losses by Study</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;tot_win&quot;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Total Wins&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;tot_los&quot;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Total Losses&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Wins/Losses by Study&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Study&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Data_Cleaning_52_0.png" src="_images/Data_Cleaning_52_0.png" />
</div>
</div>
<p>Steingroever2011 and Wetzels, as the only studies with trials of length 150, show the greatest variety in wins and losses across their participants. The Fridberg study group shows limited wins but limited losses also. This group has 15 participants so this may be a factor although Kjome shows a wider variety of wins and losses with 19 participants.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#show balance by study</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;balance&quot;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Balance&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Balance by Study&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Data_Cleaning_54_0.png" src="_images/Data_Cleaning_54_0.png" />
</div>
</div>
<p>Steingroever2011, Wood and Premkumar show the widest variety in terms of positive and negative balance of its participants. Fridberg and Kjome again vary despite their similar small group size. We can also see that the two participants from Steingroever2011 which chose deck 3 150 times had the greatest profit of 3,750 amongst all participants.</p>
</div>
<div class="section" id="analysis-of-deck-choices">
<h3>Analysis of deck choices<a class="headerlink" href="#analysis-of-deck-choices" title="Permalink to this headline">¶</a></h3>
<p>One of the features we have included in our dataframe is the number of choices of each deck. We know there are good decks and bad decks with varying rewards and punishments so this will definitely be a feature that will affect our clustering algorithm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Unique_ID&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_D&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck D&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Unique_ID&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_C&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck C&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Unique_ID&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_B&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck B&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Unique_ID&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_A&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck A&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Deck choices by Subject&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Subjects&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Data_Cleaning_56_0.png" src="_images/Data_Cleaning_56_0.png" />
</div>
</div>
<p>We can see above the tendency of participants to choice Decks 2/3/4 more than 60 times where deck 1 was never chosen this many times by any participant. We can also see the trend of a number of participants who have chose the same deck close to 100% of the trials. The large increase in choices from Subject 500 onwards is due to the trials of length 150.</p>
<p>There seems to be a unnatural distribution of choices between subjects 300-480 with a consistent number of choices being exactly 60. We will explore this data in more detail:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter1</span> <span class="o">=</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;Unique_ID&quot;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">300</span>
<span class="n">filter2</span> <span class="o">=</span> <span class="n">final</span><span class="p">[</span><span class="s2">&quot;Unique_ID&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">480</span>
<span class="n">final_zoom</span> <span class="o">=</span> <span class="n">final</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">filter1</span><span class="o">&amp;</span><span class="n">filter2</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final_zoom</span><span class="p">[</span><span class="s2">&quot;Unique_ID&quot;</span><span class="p">],</span> <span class="n">final_zoom</span><span class="p">[</span><span class="s1">&#39;Deck_D&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck D&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final_zoom</span><span class="p">[</span><span class="s2">&quot;Unique_ID&quot;</span><span class="p">],</span> <span class="n">final_zoom</span><span class="p">[</span><span class="s1">&#39;Deck_C&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck C&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final_zoom</span><span class="p">[</span><span class="s2">&quot;Unique_ID&quot;</span><span class="p">],</span> <span class="n">final_zoom</span><span class="p">[</span><span class="s1">&#39;Deck_B&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck B&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final_zoom</span><span class="p">[</span><span class="s2">&quot;Unique_ID&quot;</span><span class="p">],</span> <span class="n">final_zoom</span><span class="p">[</span><span class="s1">&#39;Deck_A&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck A&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Deck choices by Subject&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Subjects&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Choice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Data_Cleaning_58_0.png" src="_images/Data_Cleaning_58_0.png" />
</div>
</div>
<p>Further inspection on a subset of participants shows an unusual trend to choose a specific deck exactly 60 times. This is across decks 2/3/4 but again deck 1 is neglected in this. This may have been a stipulation of the study that no deck was allowed to be chosen more than 60 times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_D&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck D&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_C&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_B&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck B&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_A&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Deck Choice by Study&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Study&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;No. of Choices&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Data_Cleaning_60_0.png" src="_images/Data_Cleaning_60_0.png" />
</div>
</div>
<p>Steingroever2011 had the two most successful participants and also had the two highest choices of a single deck with two members selecting deck C 150/150 trials. There were also a number of other participants who chose a single deck more than 100 times in their study.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Payoff&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_D&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck D&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Payoff&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_C&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck C&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Payoff&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_B&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck B&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="s2">&quot;Payoff&quot;</span><span class="p">],</span> <span class="n">final</span><span class="p">[</span><span class="s1">&#39;Deck_A&#39;</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Deck A&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Deck Choice by Payoff&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Payoff&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;No. of Choices&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Data_Cleaning_62_0.png" src="_images/Data_Cleaning_62_0.png" />
</div>
</div>
<p>Interestingly payoff 2 shows a much higher selection of choices compared to payoff 1 or payoff 3. The distribution across these three is clearly quite different and so it will be interesting to see if clustering will indicate this also.</p>
</div>
</div>
<span id="document-content/K_Means_Clustering"></span><div class="section" id="data-preprocessing-standardization-and-k-means-clustering">
<h2>Data Preprocessing, Standardization, and K-means clustering<a class="headerlink" href="#data-preprocessing-standardization-and-k-means-clustering" title="Permalink to this headline">¶</a></h2>
<p>We take our cleaned and formatted data and perform a number of steps to the data to preprocess and standardize before it is ready to use with our k-means clustering algorithm.</p>
<div class="section" id="import-libraries">
<h3>Import libraries<a class="headerlink" href="#import-libraries" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">figure</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="import-data">
<h3>Import Data<a class="headerlink" href="#import-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/cleaned_data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="label-encoding-one-hot-encoding">
<h3>Label Encoding/One Hot Encoding<a class="headerlink" href="#label-encoding-one-hot-encoding" title="Permalink to this headline">¶</a></h3>
<p>We want to have our data as numerical type for the k-means clustering algorithm. Categorical data such as the column for “Study” pose a problem as the k-means algorithm cannot assign an appropriate value to a string. Two techniques that can solve this problem are label encoding and one hot encoding. Label encoding assigns a numerical value but this does not work for our dataset as it will assign values (1, 2, 3, etc.) which may imply a hierarchy that is not present in our data between each Study. We therefore explore the second option of one hot encoding which creates a new column for each of the 10 studies and then assigns the value 0 if it is not from this study or a 1 if it is. One hot encoding can cause problems when there are many categories but in this case we deemed it appropriate for use.</p>
<p>We will use the label encoding technique to convert categorical variables to numbers and then use the one hot encoding toolkit from scikit-learn to convert these into binary values. Scikit-learn has a useful preprocessing module for this.</p>
<div class="section" id="label-encoder">
<h4>Label Encoder<a class="headerlink" href="#label-encoder" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create instance of labelencoder</span>
<span class="n">labelencoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="c1"># Assign numerical values and store in a new column</span>
<span class="n">clean_data</span><span class="p">[</span><span class="s1">&#39;Study_no&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labelencoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">clean_data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Display this new column</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clean_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>index</th>
      <th>Deck_A</th>
      <th>Deck_B</th>
      <th>Deck_C</th>
      <th>Deck_D</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Subj</th>
      <th>Study</th>
      <th>Unique_ID</th>
      <th>balance</th>
      <th>Payoff</th>
      <th>Study_no</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Subj_1</td>
      <td>12</td>
      <td>9</td>
      <td>3</td>
      <td>71</td>
      <td>5800</td>
      <td>-4650</td>
      <td>1</td>
      <td>Fridberg</td>
      <td>1</td>
      <td>1150</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Subj_2</td>
      <td>24</td>
      <td>26</td>
      <td>12</td>
      <td>33</td>
      <td>7250</td>
      <td>-7925</td>
      <td>2</td>
      <td>Fridberg</td>
      <td>2</td>
      <td>-675</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Subj_3</td>
      <td>12</td>
      <td>35</td>
      <td>10</td>
      <td>38</td>
      <td>7100</td>
      <td>-7850</td>
      <td>3</td>
      <td>Fridberg</td>
      <td>3</td>
      <td>-750</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Subj_4</td>
      <td>11</td>
      <td>34</td>
      <td>12</td>
      <td>38</td>
      <td>7000</td>
      <td>-7525</td>
      <td>4</td>
      <td>Fridberg</td>
      <td>4</td>
      <td>-525</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Subj_5</td>
      <td>10</td>
      <td>24</td>
      <td>15</td>
      <td>46</td>
      <td>6450</td>
      <td>-6350</td>
      <td>5</td>
      <td>Fridberg</td>
      <td>5</td>
      <td>100</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>612</th>
      <td>93</td>
      <td>Subj_94</td>
      <td>24</td>
      <td>69</td>
      <td>13</td>
      <td>44</td>
      <td>12150</td>
      <td>-11850</td>
      <td>94</td>
      <td>Wetzels</td>
      <td>613</td>
      <td>300</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>613</th>
      <td>94</td>
      <td>Subj_95</td>
      <td>5</td>
      <td>31</td>
      <td>46</td>
      <td>68</td>
      <td>9300</td>
      <td>-7150</td>
      <td>95</td>
      <td>Wetzels</td>
      <td>614</td>
      <td>2150</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>614</th>
      <td>95</td>
      <td>Subj_96</td>
      <td>18</td>
      <td>19</td>
      <td>37</td>
      <td>76</td>
      <td>9350</td>
      <td>-7900</td>
      <td>96</td>
      <td>Wetzels</td>
      <td>615</td>
      <td>1450</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>615</th>
      <td>96</td>
      <td>Subj_97</td>
      <td>25</td>
      <td>30</td>
      <td>44</td>
      <td>51</td>
      <td>10250</td>
      <td>-9050</td>
      <td>97</td>
      <td>Wetzels</td>
      <td>616</td>
      <td>1200</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>616</th>
      <td>97</td>
      <td>Subj_98</td>
      <td>11</td>
      <td>104</td>
      <td>6</td>
      <td>29</td>
      <td>13250</td>
      <td>-15050</td>
      <td>98</td>
      <td>Wetzels</td>
      <td>617</td>
      <td>-1800</td>
      <td>2</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>617 rows × 14 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="one-hot-encoding">
<h4>One Hot Encoding<a class="headerlink" href="#one-hot-encoding" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create instance of one-hot-encoder</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># passing on Study_no column values</span>
<span class="n">enc_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">clean_data</span><span class="p">[[</span><span class="s1">&#39;Study_no&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>

<span class="c1"># rename columns as Study names</span>
<span class="n">enc_df</span> <span class="o">=</span> <span class="n">enc_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Fridberg&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Horstmann&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Kjome&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Maia&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;SteingroverInPrep&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Premkumar&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;Wood&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;Worthy&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;Steingroever2011&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;Wetzels&#39;</span><span class="p">})</span>

<span class="c1"># reset index before concatenation</span>
<span class="n">clean_data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">clean_data</span><span class="p">,</span> <span class="n">enc_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">enc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>level_0</th>
      <th>Unnamed: 0</th>
      <th>index</th>
      <th>Deck_A</th>
      <th>Deck_B</th>
      <th>Deck_C</th>
      <th>Deck_D</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Subj</th>
      <th>...</th>
      <th>Fridberg</th>
      <th>Horstmann</th>
      <th>Kjome</th>
      <th>Maia</th>
      <th>Premkumar</th>
      <th>Steingroever2011</th>
      <th>SteingroverInPrep</th>
      <th>Wetzels</th>
      <th>Wood</th>
      <th>Worthy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>Subj_1</td>
      <td>12</td>
      <td>9</td>
      <td>3</td>
      <td>71</td>
      <td>5800</td>
      <td>-4650</td>
      <td>1</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>Subj_2</td>
      <td>24</td>
      <td>26</td>
      <td>12</td>
      <td>33</td>
      <td>7250</td>
      <td>-7925</td>
      <td>2</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
      <td>Subj_3</td>
      <td>12</td>
      <td>35</td>
      <td>10</td>
      <td>38</td>
      <td>7100</td>
      <td>-7850</td>
      <td>3</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>Subj_4</td>
      <td>11</td>
      <td>34</td>
      <td>12</td>
      <td>38</td>
      <td>7000</td>
      <td>-7525</td>
      <td>4</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>Subj_5</td>
      <td>10</td>
      <td>24</td>
      <td>15</td>
      <td>46</td>
      <td>6450</td>
      <td>-6350</td>
      <td>5</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>612</th>
      <td>612</td>
      <td>93</td>
      <td>Subj_94</td>
      <td>24</td>
      <td>69</td>
      <td>13</td>
      <td>44</td>
      <td>12150</td>
      <td>-11850</td>
      <td>94</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>613</th>
      <td>613</td>
      <td>94</td>
      <td>Subj_95</td>
      <td>5</td>
      <td>31</td>
      <td>46</td>
      <td>68</td>
      <td>9300</td>
      <td>-7150</td>
      <td>95</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>614</th>
      <td>614</td>
      <td>95</td>
      <td>Subj_96</td>
      <td>18</td>
      <td>19</td>
      <td>37</td>
      <td>76</td>
      <td>9350</td>
      <td>-7900</td>
      <td>96</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>615</th>
      <td>615</td>
      <td>96</td>
      <td>Subj_97</td>
      <td>25</td>
      <td>30</td>
      <td>44</td>
      <td>51</td>
      <td>10250</td>
      <td>-9050</td>
      <td>97</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>616</th>
      <td>616</td>
      <td>97</td>
      <td>Subj_98</td>
      <td>11</td>
      <td>104</td>
      <td>6</td>
      <td>29</td>
      <td>13250</td>
      <td>-15050</td>
      <td>98</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>617 rows × 25 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="drop-columns">
<h3>Drop columns<a class="headerlink" href="#drop-columns" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;level_0&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;Subj&#39;</span><span class="p">,</span> <span class="s1">&#39;Study&#39;</span><span class="p">,</span> <span class="s1">&#39;Study_no&#39;</span><span class="p">,</span> <span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="s2">&quot;Unique_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;balance&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Deck_A</th>
      <th>Deck_B</th>
      <th>Deck_C</th>
      <th>Deck_D</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Payoff</th>
      <th>Fridberg</th>
      <th>Horstmann</th>
      <th>Kjome</th>
      <th>Maia</th>
      <th>Premkumar</th>
      <th>Steingroever2011</th>
      <th>SteingroverInPrep</th>
      <th>Wetzels</th>
      <th>Wood</th>
      <th>Worthy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12</td>
      <td>9</td>
      <td>3</td>
      <td>71</td>
      <td>5800</td>
      <td>-4650</td>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24</td>
      <td>26</td>
      <td>12</td>
      <td>33</td>
      <td>7250</td>
      <td>-7925</td>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12</td>
      <td>35</td>
      <td>10</td>
      <td>38</td>
      <td>7100</td>
      <td>-7850</td>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11</td>
      <td>34</td>
      <td>12</td>
      <td>38</td>
      <td>7000</td>
      <td>-7525</td>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10</td>
      <td>24</td>
      <td>15</td>
      <td>46</td>
      <td>6450</td>
      <td>-6350</td>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>612</th>
      <td>24</td>
      <td>69</td>
      <td>13</td>
      <td>44</td>
      <td>12150</td>
      <td>-11850</td>
      <td>2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>613</th>
      <td>5</td>
      <td>31</td>
      <td>46</td>
      <td>68</td>
      <td>9300</td>
      <td>-7150</td>
      <td>2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>614</th>
      <td>18</td>
      <td>19</td>
      <td>37</td>
      <td>76</td>
      <td>9350</td>
      <td>-7900</td>
      <td>2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>615</th>
      <td>25</td>
      <td>30</td>
      <td>44</td>
      <td>51</td>
      <td>10250</td>
      <td>-9050</td>
      <td>2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>616</th>
      <td>11</td>
      <td>104</td>
      <td>6</td>
      <td>29</td>
      <td>13250</td>
      <td>-15050</td>
      <td>2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>617 rows × 17 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="standardization">
<h3>Standardization<a class="headerlink" href="#standardization" title="Permalink to this headline">¶</a></h3>
<p>Generally speaking, learning algorithms perform better with standardized data. In our case there is a large variety in the 0 and 1 values for the studies and the total win and total loss values which vary from 14,750 to -2,725 and so we have chosen to standardize the whole data set. Scitkit-learn again offers a way to do this using the preprocessing module.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#rename columns to clearly represent decks</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Deck_A&#39;</span><span class="p">,</span> <span class="s1">&#39;Deck_B&#39;</span><span class="p">,</span> <span class="s1">&#39;Deck_C&#39;</span><span class="p">,</span> <span class="s1">&#39;Deck_D&#39;</span><span class="p">,</span> <span class="s1">&#39;tot_win&#39;</span><span class="p">,</span> <span class="s1">&#39;tot_los&#39;</span><span class="p">,</span> <span class="s1">&#39;Payoff&#39;</span><span class="p">,</span> <span class="s1">&#39;Fridberg&#39;</span><span class="p">,</span> <span class="s1">&#39;Horstmann&#39;</span><span class="p">,</span> <span class="s1">&#39;Kjome&#39;</span><span class="p">,</span> <span class="s1">&#39;Maia&#39;</span><span class="p">,</span> <span class="s1">&#39;Premkumar&#39;</span><span class="p">,</span> <span class="s1">&#39;Steingroever2011&#39;</span><span class="p">,</span> <span class="s1">&#39;SteingroverInPrep&#39;</span><span class="p">,</span> <span class="s1">&#39;Wetzels&#39;</span><span class="p">,</span> <span class="s1">&#39;Wood&#39;</span><span class="p">,</span> <span class="s1">&#39;Worthy&#39;</span><span class="p">])</span>
<span class="n">sd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Deck_A</th>
      <th>Deck_B</th>
      <th>Deck_C</th>
      <th>Deck_D</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Payoff</th>
      <th>Fridberg</th>
      <th>Horstmann</th>
      <th>Kjome</th>
      <th>Maia</th>
      <th>Premkumar</th>
      <th>Steingroever2011</th>
      <th>SteingroverInPrep</th>
      <th>Wetzels</th>
      <th>Wood</th>
      <th>Worthy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.477115</td>
      <td>-1.386904</td>
      <td>-1.089197</td>
      <td>2.131753</td>
      <td>-1.471413</td>
      <td>1.525683</td>
      <td>-1.778972</td>
      <td>6.335087</td>
      <td>-0.596694</td>
      <td>-0.178249</td>
      <td>-0.263295</td>
      <td>-0.205499</td>
      <td>-0.319039</td>
      <td>-0.35773</td>
      <td>-0.266797</td>
      <td>-0.574231</td>
      <td>-0.245229</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.024186</td>
      <td>-0.420182</td>
      <td>-0.668854</td>
      <td>0.038743</td>
      <td>-0.538613</td>
      <td>0.135451</td>
      <td>-1.778972</td>
      <td>6.335087</td>
      <td>-0.596694</td>
      <td>-0.178249</td>
      <td>-0.263295</td>
      <td>-0.205499</td>
      <td>-0.319039</td>
      <td>-0.35773</td>
      <td>-0.266797</td>
      <td>-0.574231</td>
      <td>-0.245229</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.477115</td>
      <td>0.091612</td>
      <td>-0.762264</td>
      <td>0.314139</td>
      <td>-0.635110</td>
      <td>0.167288</td>
      <td>-1.778972</td>
      <td>6.335087</td>
      <td>-0.596694</td>
      <td>-0.178249</td>
      <td>-0.263295</td>
      <td>-0.205499</td>
      <td>-0.319039</td>
      <td>-0.35773</td>
      <td>-0.266797</td>
      <td>-0.574231</td>
      <td>-0.245229</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.602224</td>
      <td>0.034746</td>
      <td>-0.668854</td>
      <td>0.314139</td>
      <td>-0.699441</td>
      <td>0.305250</td>
      <td>-1.778972</td>
      <td>6.335087</td>
      <td>-0.596694</td>
      <td>-0.178249</td>
      <td>-0.263295</td>
      <td>-0.205499</td>
      <td>-0.319039</td>
      <td>-0.35773</td>
      <td>-0.266797</td>
      <td>-0.574231</td>
      <td>-0.245229</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.727332</td>
      <td>-0.533914</td>
      <td>-0.528740</td>
      <td>0.754773</td>
      <td>-1.053262</td>
      <td>0.804036</td>
      <td>-1.778972</td>
      <td>6.335087</td>
      <td>-0.596694</td>
      <td>-0.178249</td>
      <td>-0.263295</td>
      <td>-0.205499</td>
      <td>-0.319039</td>
      <td>-0.35773</td>
      <td>-0.266797</td>
      <td>-0.574231</td>
      <td>-0.245229</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>612</th>
      <td>1.024186</td>
      <td>2.025056</td>
      <td>-0.622150</td>
      <td>0.644614</td>
      <td>2.613607</td>
      <td>-1.530705</td>
      <td>-0.262914</td>
      <td>-0.157851</td>
      <td>-0.596694</td>
      <td>-0.178249</td>
      <td>-0.263295</td>
      <td>-0.205499</td>
      <td>-0.319039</td>
      <td>-0.35773</td>
      <td>3.748170</td>
      <td>-0.574231</td>
      <td>-0.245229</td>
    </tr>
    <tr>
      <th>613</th>
      <td>-1.352875</td>
      <td>-0.135852</td>
      <td>0.919107</td>
      <td>1.966515</td>
      <td>0.780173</td>
      <td>0.464437</td>
      <td>-0.262914</td>
      <td>-0.157851</td>
      <td>-0.596694</td>
      <td>-0.178249</td>
      <td>-0.263295</td>
      <td>-0.205499</td>
      <td>-0.319039</td>
      <td>-0.35773</td>
      <td>3.748170</td>
      <td>-0.574231</td>
      <td>-0.245229</td>
    </tr>
    <tr>
      <th>614</th>
      <td>0.273535</td>
      <td>-0.818244</td>
      <td>0.498764</td>
      <td>2.407149</td>
      <td>0.812338</td>
      <td>0.146063</td>
      <td>-0.262914</td>
      <td>-0.157851</td>
      <td>-0.596694</td>
      <td>-0.178249</td>
      <td>-0.263295</td>
      <td>-0.205499</td>
      <td>-0.319039</td>
      <td>-0.35773</td>
      <td>3.748170</td>
      <td>-0.574231</td>
      <td>-0.245229</td>
    </tr>
    <tr>
      <th>615</th>
      <td>1.149295</td>
      <td>-0.192718</td>
      <td>0.825698</td>
      <td>1.030169</td>
      <td>1.391318</td>
      <td>-0.342110</td>
      <td>-0.262914</td>
      <td>-0.157851</td>
      <td>-0.596694</td>
      <td>-0.178249</td>
      <td>-0.263295</td>
      <td>-0.205499</td>
      <td>-0.319039</td>
      <td>-0.35773</td>
      <td>3.748170</td>
      <td>-0.574231</td>
      <td>-0.245229</td>
    </tr>
    <tr>
      <th>616</th>
      <td>-0.602224</td>
      <td>4.015366</td>
      <td>-0.949083</td>
      <td>-0.181574</td>
      <td>3.321249</td>
      <td>-2.889100</td>
      <td>-0.262914</td>
      <td>-0.157851</td>
      <td>-0.596694</td>
      <td>-0.178249</td>
      <td>-0.263295</td>
      <td>-0.205499</td>
      <td>-0.319039</td>
      <td>-0.35773</td>
      <td>3.748170</td>
      <td>-0.574231</td>
      <td>-0.245229</td>
    </tr>
  </tbody>
</table>
<p>617 rows × 17 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="k-means-clustering">
<h3>K- means clustering<a class="headerlink" href="#k-means-clustering" title="Permalink to this headline">¶</a></h3>
<p>Clustering involves grouping data points into groups based on their distance to the centroid of each cluster. It is an unsupervised technique using patterns within the data to decide upon the chosen groups. Within k-means, the k represents the number of clusters we require. We choose this value for k and so the best way to determine the most appropriate value of k is to run experiments for different values of k and then see which results in the least error.</p>
<div class="section" id="k-means-steps">
<h4>K means steps:<a class="headerlink" href="#k-means-steps" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>The value of k must be decided</p></li>
<li><p>k random points are selected as the initial centroids</p></li>
<li><p>Each data point is assigned to a cluster based on their distance from the nearest initial centroid.</p></li>
<li><p>A new centroid is then calculated from each cluster</p></li>
<li><p>This process is iterated over until the data points settle in their appropriate cluster</p></li>
</ul>
<p>This measure of distance d is the euclidean distance given by:</p>
<div class="math notranslate nohighlight">
\[d = √((x1-y1)² + (x2-y2)²)\]</div>
</div>
</div>
<div class="section" id="pca-dimensionality-reduction">
<h3>PCA dimensionality reduction<a class="headerlink" href="#pca-dimensionality-reduction" title="Permalink to this headline">¶</a></h3>
<p>Principal component analysis is a method whereby we can reduce the dimensions used to represent our data. This can help with the curse of dimensionality which can often make clustering algorithms challenging with so many features. PCA helps us by taking all of these features and represents the data within a new set of features (the number of which we can decide). This can often help with the visualisation of cluster as we can reduce the features to 2 components which will healp to plot our points and therefore visualise the clustering algorithm and how well it represents our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#select how many features we want</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#transform data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">sd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="choosing-the-value-for-k">
<h3>Choosing the value for k<a class="headerlink" href="#choosing-the-value-for-k" title="Permalink to this headline">¶</a></h3>
<p>The first step in the k-means algorithm involves calculating what is the most appropriate value for k. We will explore the elbow method and the silhoutte coefficient to determine our value for k within this project.</p>
<p>From our data exploration thus far we are interested in whether the data should be partitioned in 10 groups (k=10) for each study we have, or whether clustering would be best in 3 groups(k=3) to reflect the 3 payoff schemes we have seen.</p>
<div class="section" id="elbow-method">
<h4>Elbow Method<a class="headerlink" href="#elbow-method" title="Permalink to this headline">¶</a></h4>
<p>The elbow method involves calculating the sum of squared error (SSE) and deciding at what point the modelling of the data is most appropriate. Often we can add further clusters without much gain in SSE and so we must determine at which point any further returns are no longer worthwhile.</p>
<div class="math notranslate nohighlight">
\[ SSE = \sum_{i=1}^n (y_i-ŷ_i)^2\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;init&quot;</span><span class="p">:</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="s2">&quot;n_init&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;max_iter&quot;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
    <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># A list holds the SSE values for each k</span>
<span class="n">sse</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">kmeans_kwargs</span><span class="p">)</span>
    <span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">sse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">sse</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Clusters&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;SSE&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/K_Means_Clustering_21_0.png" src="_images/K_Means_Clustering_21_0.png" />
</div>
</div>
<p>k=3 appears to be a good fit using the elbow method and SSE</p>
</div>
<div class="section" id="silhouette-coefficient">
<h4>Silhouette Coefficient<a class="headerlink" href="#silhouette-coefficient" title="Permalink to this headline">¶</a></h4>
<p>The Silhouette coefficient is another measure of clustering and ranges between -1 and 1</p>
<p>This value is calculated by the following equation:</p>
<div class="math notranslate nohighlight">
\[(y-x)/max(x,y)\]</div>
<p>Where:</p>
<p>x = average distance between each point in a cluster</p>
<p>y = average distance between all clusters</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A list holds the silhouette coefficients for each k</span>
<span class="n">silhouette_coefficients</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">kmeans_kwargs</span><span class="p">)</span>
    <span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
    <span class="n">silhouette_coefficients</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">silhouette_coefficients</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Clusters&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Silhouette Coefficient&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/K_Means_Clustering_24_0.png" src="_images/K_Means_Clustering_24_0.png" />
</div>
</div>
<p>Again we see that k=3 returns the highest value for the silhouette coefficient confirming that payoff scheme may be the most defining feature in the data for the outcome of the Iowa Gambling task. We will proceed to cluster with k=3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
 
<span class="c1">#predict the labels of clusters.</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
 
<span class="c1">#Getting unique labels</span>
<span class="n">u_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
 
<span class="c1">#plotting the results:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u_labels</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="n">i</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="n">i</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Component 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Component 2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/K_Means_Clustering_26_0.png" src="_images/K_Means_Clustering_26_0.png" />
</div>
</div>
<p>Interestingly this instance of k-means has split the data into three clusters which may not intuitively be the ideal clusters. This can often be a limiting factor when using k-means. We now add the Payoff labels back onto the data to visuakise the same points with each payoff scheme identified by a different color.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Component_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Component_2&#39;</span><span class="p">])</span>


<span class="n">original_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">tmp</span><span class="p">,</span> <span class="n">clean_data</span><span class="p">[[</span><span class="s2">&quot;Study&quot;</span><span class="p">,</span> <span class="s2">&quot;Payoff&quot;</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">original_labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Component_1</th>
      <th>Component_2</th>
      <th>Study</th>
      <th>Payoff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-2.954758</td>
      <td>1.588772</td>
      <td>Fridberg</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.803481</td>
      <td>1.928634</td>
      <td>Fridberg</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.099105</td>
      <td>2.030063</td>
      <td>Fridberg</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.279225</td>
      <td>2.022929</td>
      <td>Fridberg</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-2.055069</td>
      <td>1.879925</td>
      <td>Fridberg</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>612</th>
      <td>4.101098</td>
      <td>1.061375</td>
      <td>Wetzels</td>
      <td>2</td>
    </tr>
    <tr>
      <th>613</th>
      <td>0.162405</td>
      <td>0.589999</td>
      <td>Wetzels</td>
      <td>2</td>
    </tr>
    <tr>
      <th>614</th>
      <td>0.561677</td>
      <td>0.383470</td>
      <td>Wetzels</td>
      <td>2</td>
    </tr>
    <tr>
      <th>615</th>
      <td>1.692721</td>
      <td>0.610973</td>
      <td>Wetzels</td>
      <td>2</td>
    </tr>
    <tr>
      <th>616</th>
      <td>5.655661</td>
      <td>1.538607</td>
      <td>Wetzels</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>617 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Fridberg&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;Horstmann&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;Kjome&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;Maia&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="s1">&#39;SteingroverInPrep&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;Premkumar&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;Wood&#39;</span><span class="p">:</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span><span class="s1">&#39;Worthy&#39;</span><span class="p">:</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="s1">&#39;Steingroever2011&#39;</span><span class="p">:</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span><span class="s1">&#39;Wetzels&#39;</span><span class="p">:</span> <span class="s1">&#39;pink&#39;</span><span class="p">}</span>
<span class="c1">#for i in range(618):</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">original_labels</span><span class="p">[</span><span class="s1">&#39;Component_1&#39;</span><span class="p">],</span> <span class="n">original_labels</span><span class="p">[</span><span class="s2">&quot;Component_2&quot;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="n">original_labels</span><span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Component 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Component 2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">colors</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/K_Means_Clustering_30_0.png" src="_images/K_Means_Clustering_30_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fridberg: blue
Horstmann: red
Kjome: green
Maia: yellow
SteingroverInPrep: black
Premkumar: orange
Wood: purple
Worthy: grey
Steingroever2011: brown
Wetzels: pink
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">}</span>
<span class="c1">#for i in range(618):</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">original_labels</span><span class="p">[</span><span class="s2">&quot;Component_1&quot;</span><span class="p">],</span> <span class="n">original_labels</span><span class="p">[</span><span class="s2">&quot;Component_2&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">original_labels</span><span class="p">[</span><span class="s2">&quot;Payoff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Component 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Component 2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Clustering by Payoff&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/K_Means_Clustering_31_0.png" src="_images/K_Means_Clustering_31_0.png" />
</div>
</div>
<p>We can see that the payoff data clearly has a large impact on our clusters that we have created. All data points have been assigned to the same cluster as other data points in their payoff.</p>
</div>
</div>
<div class="section" id="k-10-without-payoff-data">
<h3>k=10 (without payoff data)<a class="headerlink" href="#k-10-without-payoff-data" title="Permalink to this headline">¶</a></h3>
<p>To explore the possibility that our data is impacted by the study in which it was recorded we drop the payoff column and then reduce the dimensionality before computing our clusters with k=10</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#drop payoff column</span>
<span class="n">w_out_payoff</span> <span class="o">=</span> <span class="n">sd</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Payoff&quot;</span><span class="p">])</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">w_out</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">w_out_payoff</span><span class="p">)</span>

<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
 
<span class="c1">#predict the labels of clusters.</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">w_out</span><span class="p">)</span>
 
<span class="c1">#Getting unique labels</span>
<span class="n">u_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
 
<span class="c1">#plotting the results:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u_labels</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">w_out</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="n">i</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">w_out</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="n">i</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Component 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Component 2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/K_Means_Clustering_34_0.png" src="_images/K_Means_Clustering_34_0.png" />
</div>
</div>
<p>We then plot the same data points but clustering by study using a unique color for each</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">w_out</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Component_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Component_2&#39;</span><span class="p">])</span>


<span class="n">t_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">t</span><span class="p">,</span> <span class="n">clean_data</span><span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Fridberg&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;Horstmann&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;Kjome&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;Maia&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="s1">&#39;SteingroverInPrep&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;Premkumar&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;Wood&#39;</span><span class="p">:</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span><span class="s1">&#39;Worthy&#39;</span><span class="p">:</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="s1">&#39;Steingroever2011&#39;</span><span class="p">:</span> <span class="s1">&#39;brown&#39;</span><span class="p">,</span><span class="s1">&#39;Wetzels&#39;</span><span class="p">:</span> <span class="s1">&#39;pink&#39;</span><span class="p">}</span>
<span class="c1">#for i in range(618):</span>
<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t_labels</span><span class="p">[</span><span class="s1">&#39;Component_1&#39;</span><span class="p">],</span> <span class="n">t_labels</span><span class="p">[</span><span class="s2">&quot;Component_2&quot;</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="n">t_labels</span><span class="p">[</span><span class="s2">&quot;Study&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Component 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Component 2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#show study-colors</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">colors</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/K_Means_Clustering_36_0.png" src="_images/K_Means_Clustering_36_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fridberg: blue
Horstmann: red
Kjome: green
Maia: yellow
SteingroverInPrep: black
Premkumar: orange
Wood: purple
Worthy: grey
Steingroever2011: brown
Wetzels: pink
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h3>
<p>The two features we have identified, Payoff scheme and study, have clearly impacted the results of this clustering algorithm. The clusters for payoff show how strongly weighted this was within the clustering algorithm. We can agree from this that the appropriate value for k is 3 and that using k=10 can also tell us an interesting insight into how using study as a features may affect the final clustering result.</p>
</div>
</div>
<span id="document-content/Privacy_preserving_k_means"></span><div class="section" id="privacy-preserving-k-means">
<h2>Privacy Preserving k-means<a class="headerlink" href="#privacy-preserving-k-means" title="Permalink to this headline">¶</a></h2>
<p>Data privacy is an extremely sensitive topic which requires a selection of methods/techniques when processing or using individuals data. Some new approaches to this involve the creation of synthetic data or the move away from sharing any individuals data at all to a single central data source. This second approach involves processing data at source and sharing only the key information centrally. This can mean processing data within a device, or at a central source (i.e. within a single study) and then sharing only the key information that is needed about that data. This section will discuss how information could be shared in this case between studies to gain a central cluster without passing on any individuals data from one study to another.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">figure</span>
<span class="kn">import</span> <span class="nn">array</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/cleaned_data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>index</th>
      <th>Deck_A</th>
      <th>Deck_B</th>
      <th>Deck_C</th>
      <th>Deck_D</th>
      <th>tot_win</th>
      <th>tot_los</th>
      <th>Subj</th>
      <th>Study</th>
      <th>Unique_ID</th>
      <th>balance</th>
      <th>Payoff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Subj_1</td>
      <td>12</td>
      <td>9</td>
      <td>3</td>
      <td>71</td>
      <td>5800</td>
      <td>-4650</td>
      <td>1</td>
      <td>Fridberg</td>
      <td>1</td>
      <td>1150</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Subj_2</td>
      <td>24</td>
      <td>26</td>
      <td>12</td>
      <td>33</td>
      <td>7250</td>
      <td>-7925</td>
      <td>2</td>
      <td>Fridberg</td>
      <td>2</td>
      <td>-675</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Subj_3</td>
      <td>12</td>
      <td>35</td>
      <td>10</td>
      <td>38</td>
      <td>7100</td>
      <td>-7850</td>
      <td>3</td>
      <td>Fridberg</td>
      <td>3</td>
      <td>-750</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Subj_4</td>
      <td>11</td>
      <td>34</td>
      <td>12</td>
      <td>38</td>
      <td>7000</td>
      <td>-7525</td>
      <td>4</td>
      <td>Fridberg</td>
      <td>4</td>
      <td>-525</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Subj_5</td>
      <td>10</td>
      <td>24</td>
      <td>15</td>
      <td>46</td>
      <td>6450</td>
      <td>-6350</td>
      <td>5</td>
      <td>Fridberg</td>
      <td>5</td>
      <td>100</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>612</th>
      <td>93</td>
      <td>Subj_94</td>
      <td>24</td>
      <td>69</td>
      <td>13</td>
      <td>44</td>
      <td>12150</td>
      <td>-11850</td>
      <td>94</td>
      <td>Wetzels</td>
      <td>613</td>
      <td>300</td>
      <td>2</td>
    </tr>
    <tr>
      <th>613</th>
      <td>94</td>
      <td>Subj_95</td>
      <td>5</td>
      <td>31</td>
      <td>46</td>
      <td>68</td>
      <td>9300</td>
      <td>-7150</td>
      <td>95</td>
      <td>Wetzels</td>
      <td>614</td>
      <td>2150</td>
      <td>2</td>
    </tr>
    <tr>
      <th>614</th>
      <td>95</td>
      <td>Subj_96</td>
      <td>18</td>
      <td>19</td>
      <td>37</td>
      <td>76</td>
      <td>9350</td>
      <td>-7900</td>
      <td>96</td>
      <td>Wetzels</td>
      <td>615</td>
      <td>1450</td>
      <td>2</td>
    </tr>
    <tr>
      <th>615</th>
      <td>96</td>
      <td>Subj_97</td>
      <td>25</td>
      <td>30</td>
      <td>44</td>
      <td>51</td>
      <td>10250</td>
      <td>-9050</td>
      <td>97</td>
      <td>Wetzels</td>
      <td>616</td>
      <td>1200</td>
      <td>2</td>
    </tr>
    <tr>
      <th>616</th>
      <td>97</td>
      <td>Subj_98</td>
      <td>11</td>
      <td>104</td>
      <td>6</td>
      <td>29</td>
      <td>13250</td>
      <td>-15050</td>
      <td>98</td>
      <td>Wetzels</td>
      <td>617</td>
      <td>-1800</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>617 rows × 13 columns</p>
</div></div></div>
</div>
<div class="section" id="clustering-by-study">
<h3>Clustering by study<a class="headerlink" href="#clustering-by-study" title="Permalink to this headline">¶</a></h3>
<p>We cluster each study individually with k=3 and display these clusters below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fridberg</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Fridberg&#39;</span><span class="p">]</span>
<span class="n">Horstmann</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Horstmann&#39;</span><span class="p">]</span>
<span class="n">Kjome</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Kjome&#39;</span><span class="p">]</span>
<span class="n">Maia</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Maia&#39;</span><span class="p">]</span>
<span class="n">SteingroverInPrep</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;SteingroverInPrep&#39;</span><span class="p">]</span>
<span class="n">Premkumar</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Premkumar&#39;</span><span class="p">]</span>
<span class="n">Wood</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Wood&#39;</span><span class="p">]</span>
<span class="n">Worthy</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Worthy&#39;</span><span class="p">]</span>
<span class="n">Steingroever2011</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Steingroever2011&#39;</span><span class="p">]</span>
<span class="n">Wetzels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Study&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Wetzels&#39;</span><span class="p">]</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">Fridberg</span><span class="p">,</span> <span class="n">Horstmann</span><span class="p">,</span> <span class="n">Kjome</span><span class="p">,</span> <span class="n">Maia</span><span class="p">,</span> <span class="n">SteingroverInPrep</span><span class="p">,</span> <span class="n">Premkumar</span><span class="p">,</span> <span class="n">Wood</span><span class="p">,</span> <span class="n">Worthy</span><span class="p">,</span> <span class="n">Steingroever2011</span><span class="p">,</span> <span class="n">Wetzels</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clusters</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;Subj&#39;</span><span class="p">,</span> <span class="s1">&#39;Study&#39;</span><span class="p">,</span> <span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Unique_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;balance&#39;</span><span class="p">])</span>

    <span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="c1">#rename columns to clearly represent decks</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Deck_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Deck_2&#39;</span><span class="p">,</span> <span class="s1">&#39;Deck_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Deck_4&#39;</span><span class="p">,</span> <span class="s1">&#39;tot_win&#39;</span><span class="p">,</span> <span class="s1">&#39;tot_los&#39;</span><span class="p">,</span> <span class="s1">&#39;Payoff&#39;</span><span class="p">])</span>
    <span class="n">sd</span>

    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">sd</span><span class="p">)</span>

    <span class="c1">#w_out = pd.DataFrame(df, columns=[&#39;Component_1&#39;, &#39;Component_2&#39;])</span>
    <span class="c1">#w_out_payoff = sd.drop(columns=[&quot;Payoff&quot;])</span>

    <span class="c1">#w_out = pca.fit_transform(w_out_payoff)</span>

    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
 
    <span class="c1">#predict the labels of clusters.</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">label</span><span class="p">:</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
 
    <span class="c1">#Getting unique labels</span>
    <span class="n">u_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

    <span class="n">centroids</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">cluster_centers_</span>
    <span class="n">clusters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">centroids</span><span class="p">)</span>
    
    <span class="c1">#plotting the results:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u_labels</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="n">i</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="n">i</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Component 1&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Component 2&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Privacy_preserving_k_means_6_0.png" src="_images/Privacy_preserving_k_means_6_0.png" />
<img alt="_images/Privacy_preserving_k_means_6_1.png" src="_images/Privacy_preserving_k_means_6_1.png" />
<img alt="_images/Privacy_preserving_k_means_6_2.png" src="_images/Privacy_preserving_k_means_6_2.png" />
<img alt="_images/Privacy_preserving_k_means_6_3.png" src="_images/Privacy_preserving_k_means_6_3.png" />
<img alt="_images/Privacy_preserving_k_means_6_4.png" src="_images/Privacy_preserving_k_means_6_4.png" />
<img alt="_images/Privacy_preserving_k_means_6_5.png" src="_images/Privacy_preserving_k_means_6_5.png" />
<img alt="_images/Privacy_preserving_k_means_6_6.png" src="_images/Privacy_preserving_k_means_6_6.png" />
<img alt="_images/Privacy_preserving_k_means_6_7.png" src="_images/Privacy_preserving_k_means_6_7.png" />
<img alt="_images/Privacy_preserving_k_means_6_8.png" src="_images/Privacy_preserving_k_means_6_8.png" />
<img alt="_images/Privacy_preserving_k_means_6_9.png" src="_images/Privacy_preserving_k_means_6_9.png" />
</div>
</div>
</div>
<div class="section" id="centroid-collection">
<h3>Centroid collection<a class="headerlink" href="#centroid-collection" title="Permalink to this headline">¶</a></h3>
<p>We make a list called clusters above, with all of the centroids for each of the studies and plot these all together in the next cell. This gives an indication of each studies data distribution without providing any raw data centrally.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">clusters</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">arr</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Centroids across all studies&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Component 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Component 2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Privacy_preserving_k_means_8_0.png" src="_images/Privacy_preserving_k_means_8_0.png" />
</div>
</div>
</div>
<div class="section" id="final-clustering">
<h3>Final clustering<a class="headerlink" href="#final-clustering" title="Permalink to this headline">¶</a></h3>
<p>We then cluster these centroids to see what our final distribution is like</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
 
<span class="c1">#predict the labels of clusters.</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
 
<span class="c1">#Getting unique labels</span>
<span class="n">u_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

    
<span class="c1">#plotting the results:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u_labels</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="n">i</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="n">label</span> <span class="o">==</span> <span class="n">i</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">i</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="c1">#plt.title()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Component 1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Component 2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Privacy_preserving_k_means_10_0.png" src="_images/Privacy_preserving_k_means_10_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="analysis">
<h2>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h2>
<p>This is an incredibly simplistic and naive method of privacy preserving clustering. The use of centroids causes issues as some centroids will have been created with very few points and others with a large number of data points and hence the clustering will be quite poor in comparison to the original clustering effort. Some more work would need to be done to explore a better way of protecting individuals privacy while allowing us to centrally analyse our data using k-means.</p>
</div>
<span id="document-conclusion"></span><div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>This study involved analysing the data from the Iowa Gambling task across 10 different studies with 617 participants. Initial data analysis showed a clear trend of choices away from the bad decks and towards the good decks which rewarded contestants who chose consistently across all trials. There was some interesting participants choices such as two participants who selected the same deck for 150/150 trials but the vast majority showed an ability to learn throughout the study and choose the good decks more often than not.</p>
<p>Our clustering analysis focused on the clusters across payoff schemes (k=3) and across studies (k=10). The three payoff schemes were all different in some aspects of their rewards and punishments. After analysing the data we found that payoff scheme was the largest contributing factor to the clusters followed by the study within which our participants came from.</p>
<div class="section" id="future-work">
<h3>Future work<a class="headerlink" href="#future-work" title="Permalink to this headline">¶</a></h3>
<p>This assignment was a very simple approach to clustering with no prior practical knowledge of k-means. Hence this analysis is quite basic in nature but provided a good insight into k-means and its potential uses and limitations. In the future it would be good to further explore this data set and address the health of individuals and how this affects their choices over time.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By George Dockrell<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>